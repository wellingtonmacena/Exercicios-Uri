from openpyxl import Workbook, load_workbook
import xlwt

class Wrapper_excel:
    opcao = 0
    def __init__(self):
        self.opcao = int(input("Digite a extensão desejada: 1(xlsx) ou 2(xls): "))
        while(self.opcao != 1 and self.opcao!=2):
            self.opcao = int(input("Opção inválida. Tente novamente: "))

    if opcao == 1:
        arquivo_excel = Workbook()
        arquivo_atual = arquivo_excel.active

        def EscreverNaCelula(self, celula, valor):
            self.arquivo_atual[celula] = valor

        def addDados(self, *dados):
            self.arquivo_atual.append(dados)

        def carregarArquivo(self,nomeArquivo):
            novo_arquivo = load_workbook(f"{nomeArquivo}.xlsx")
            return novo_arquivo

        def criarCabecalho(self, *strings):
            self.arquivo_atual.append(strings)

        def criarNovaPlanilha(self, nome, posicao=0):
            self.arquivo_excel.create_sheet(nome, posicao)

        def nomePlanilhas(self):
            print(self.arquivo_excel.sheetnames)

        def renomearPlanilha(self, nome):
            self.arquivo_atual.title = nome

        def salvarArquivo(self, nomeDoArquivo):
            self.arquivo_excel.save(f"{nomeDoArquivo}.xlsx")

    else:
        arquivo_excel = xlwt.Workbook()
        planilha1 = arquivo_excel.add_sheet("Planilha1")

        def addDados(self,coluna,linha, *entrada):
            elementos = entrada
            for dado in elementos:
                indice_dado = 0
                for item in dado:
                    self.planilha1.write(coluna, indice_dado, dado)
                    indice_dado += 1
                linha += 1


        def EscreverNaCelula(self,linha,coluna,valor):
            self.planilha1.write(linha,coluna,valor)

        def criarCabecalho(self, colunaInicial, linhaInicial, *entrada):
            elementos = entrada

            for item in elementos:
                self.planilha1.write(colunaInicial,linhaInicial, item)
                linhaInicial +=1

            linhaInicial = 0

        def criarNovaPlanilha(self, nome):
            self.arquivo_excel.add_sheet(f"{nome}")

        #def renomearPlanilha(self, nome):


        def salvarArquivo(self, nome):
            self.arquivo_excel.save(f"{nome}.xls")


objExcel = Wrapper_excel()
objExcel.criarCabecalho(1,1,"carro","moto", "caminhão","barco")
objExcel.addDados(4, 5,"a", "b", "c","d","e")
objExcel.salvarArquivo("testeXlsx")
